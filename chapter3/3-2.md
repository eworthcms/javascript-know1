# 隐藏内部实现

## 最小暴露,隐藏无关细节

把一段代码用函数声明包装起来，就会在代码片段的周围创建了一个作用域气泡，也就是说这段代码中的任何声明（变量或函数）都将绑定在这个新创建的包装函数的作用域中。

可以把变量和函数包裹在一个函数的作用域中，然后用这个作用域来“隐藏”它们。

“最小特权”原则引申出来的 最小授权 或 最小暴露 原则，指的是应该最小限度地暴露必要内容，而将其他内容都隐藏起来，比如某个模块或对象的 API 设计。



```javascript
function doSomething(a){
    function doSomethingElse(a){
        return a - 1;
    }
    var b;
    b = a + doSomethingElse(a * 2);
    console.log(b * 3);
}
doSomething(2);  //15
```



## 规避冲突

可以避免同名标识符的冲突。

```javascript
//相同的i可避免冲突
function foo(){
    function bar(a){
        var i = 3;
    }
    for(var i=0;i<10;i++){
        bar(i * 2);
    }
}
```

### 全局命名空间

在全局作用域中，当程序中加载了多个第三方库时，如果没有妥善的将内部私有的函数或变量隐藏起来，容易导致冲突。

这些库通常在全局作用域中声明一个名字独特的变量，通常是一个对象。这个对象被叫做库的命名空间，所有需要暴露给外界的功能都会成为这个对象（命名空间）的属性，而不是将自己的标识符暴露在顶级的词法作用域中。



```javascript
var MyReallyCoolLibrary = {
    awesome: 'stuff',
    doSomething: function(){
        //..
    },
    doAnotherThing: function(){
        //..
    }
}
```

### 模块管理

从模块管理器中选一个来使用。requirejs、seajs等。使用这些工具，任何库都无需将标识符加入到全局作用域中，而是通过依赖管理器的机制将库的标识符显式地导入到另外一个特定的作用域中。

模块管理器 只是利用作用域的规则强制所有标识符都不能注入到共享作用域中，而是保持在私有、无冲突的作用域中，这样可以有效规避意外冲突。





















